<dom-module id="inspector-script-section">
    <style>
    </style>

    <template>
        <editor-section text="[[target.__type__]]">
            <template is="dom-repeat" items="{{_props(target)}}">
                <editor-prop
                    name="[[item.name]]"
                    type="[[item.type]]"
                    attrs="[[item.attrs]]"
                    value="{{item.value}}"
                    on-value-changed="_onValueChanged"
                >
                </editor-prop>
            </template>
        </editor-section>
    </template>
</dom-module>

<script>
    Polymer({
        is: 'inspector-script-section',

        properties: {
            target: {
                type: Object,
                value: null,
                notify: true,
            },
        },

        _props: function ( target ) {
            var props = [];
            for ( var p in target ) {
                if ( p === '__type__' )
                    continue;

                if ( p.indexOf('_') !== -1 )
                    continue;

                props.push ( target[p] );
            }
            return props;
        },

        _onValueChanged: function ( event ) {
            var mixinType = this.target.__type__;
            var propEL = Polymer.dom(event).localTarget
            var subPath = event.detail.path;

            if ( subPath ) {
                this.notifyPath('target.' + mixinType + '.' + propEL.name + '.' + subPath,
                                event.detail.value );
            } else {
                this.notifyPath('target.' + mixinType + '.' + propEL.name,
                                event.detail.value );
            }
        },
    });
</script>
